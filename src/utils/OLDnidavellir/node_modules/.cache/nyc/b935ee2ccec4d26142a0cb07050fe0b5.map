{"version":3,"file":"tests.cjs.js","sources":["../src/utils/jsonSearch.js","../test/utils/fixtures/jsonSearch.js","../test/utils/jsonSearch.js"],"sourcesContent":["// @flow\n\nimport { type JsonSearchParams } from '../../types/utils'\n\nexport const search = (searchParams: JsonSearchParams, jsonObj: any): any => {\n  // if (Array.isArray(jsonObj)) {\n  //   for (const item of jsonObj) {\n  //     try {\n  //       return search(searchParams, item)\n  //     } catch (e) {}\n  //   }\n  //   throw new Error('Unknown prefix')\n  // }\n\n  if (typeof jsonObj === 'undefined') return null\n\n  const {\n    keyToMatch,\n    valueToMatch,\n    // keyToReturn,\n    parent,\n    tokenizeKeys = keyToMatch ? keyToMatch.split('.') : []\n  } = searchParams\n\n  if (!tokenizeKeys.length) {\n    if (typeof valueToMatch === 'undefined' || valueToMatch === jsonObj) {\n      return parent ? [parent] : [jsonObj]\n    }\n    return null\n  }\n\n  let results = []\n\n  // if (Array.isArray(jsonObj)) {\n  //   for (const child of jsonObj) {\n  //     const result = search({\n  //       keyToMatch,\n  //       valueToMatch,\n  //       // keyToReturn,\n  //       parent,\n  //       tokenizeKeys\n  //     }, child)\n  //     if (result) {\n  //       results = results.concat(result)\n  //     }\n  //   }\n  // } else\n\n  if (typeof jsonObj === 'object') {\n    console.log('0. tokenizeKeys', tokenizeKeys)\n    console.log('0. jsonObj', jsonObj)\n    // Search one level down based on the first key in tokenizeKeys with ourself as the parent\n    const result = search({\n      keyToMatch,\n      valueToMatch,\n      // keyToReturn,\n      parent: jsonObj,\n      tokenizeKeys: tokenizeKeys.slice(1)\n    }, jsonObj[tokenizeKeys[0]])\n\n    if (result) {\n      console.log('1. Single Result:', result)\n      results = results.concat(result)\n    }\n\n    // If there is no parent yet, it means that we still have the full tokenizeKeys\n    // So we will try to use the same tokenizeKeys for every child of jsonObj\n    if (!parent) {\n      console.log('2. jsonObj', jsonObj)\n      for (const key in jsonObj) {\n        console.log('2. key', key)\n        const result = search({\n          keyToMatch,\n          valueToMatch,\n          // keyToReturn,\n          tokenizeKeys\n        }, jsonObj[key])\n        if (result) {\n          console.log('3. Multiple Results:', result)\n          results = results.concat(result)\n        }\n      }\n    }\n  }\n\n  return results.length ? results : null\n}\n","export const jsonObj = {\n  alpha: 1,\n  bravo: [1, 2, 3],\n  charlie: { delta: 1 },\n  india: {\n    kilo: 4,\n    lima: 4\n  },\n  uniform: {\n    kilo: 4,\n    lima: 4\n  },\n  echo: {\n    foxtrot: [1, 2, 3],\n    golf: {\n      india: {\n        kilo: 4,\n        lima: 4\n      },\n      juliet: {\n        kilo: 4,\n        lima: 5\n      },\n      mike: [\n        { kilo: 4 },\n        6,\n        { lima: 5 },\n        { lima: 6, kilo: 7 },\n        { charlie: { delta: 1 } },\n        { alpha: 1 },\n        [ 6, { lima: 5 }, 10 ]\n      ],\n      november: 8\n    }\n  }\n}\n\nexport const fixtures = [\n  // [ [], [jsonObj] ],\n  // [ ['alpha', 1], [\n  //   jsonObj,\n  //   jsonObj['echo']['golf']['mike'][5]\n  // ] ],\n  // [ ['alpha', 2], null ],\n  // [ ['bravo', 0], null ],\n  [ ['bravo', 1], [jsonObj['bravo']] ],\n  // [ ['charlie', 1], null ],\n  // [ ['charlie.delta', 1], [\n  //   jsonObj['charlie'],\n  //   jsonObj['echo']['golf']['mike'][4]['charlie']\n  // ] ],\n  // [ ['india.kilo', 5], null ],\n  // [ ['india.lima', 5], null ],\n\n  [ ['echo.foxtrot', 2], [\n    jsonObj['echo']['foxtrot']\n  ] ]\n\n  // [ ['echo.golf.india.kilo', 4], [jsonObj['echo']['golf']['india']] ],\n  // [ ['echo.golf.india.kilo', 5], null ],\n  // [ ['echo.golf.november', 8], [jsonObj['echo']['golf']] ],\n\n  // [ ['india.kilo', 4], [\n  //   jsonObj['india'],\n  //   jsonObj['echo']['golf']['india']\n  // ] ],\n\n  // [ ['lima', 5], [\n  //   jsonObj['echo']['golf']['juliet'],\n  //   jsonObj['echo']['golf']['mike'][2],\n  //   jsonObj['echo']['golf']['mike'][6][1]\n  // ] ],\n\n  // [ ['lima', 4], [\n  //   jsonObj['india'],\n  //   jsonObj['uniform'],\n  //   jsonObj['echo']['golf']['india']\n  // ] ],\n\n  // [ ['kilo', 4], [\n  //   jsonObj['india'],\n  //   jsonObj['uniform'],\n  //   jsonObj['echo']['golf']['india'],\n  //   jsonObj['echo']['golf']['juliet'],\n  //   jsonObj['echo']['golf']['mike'][0]\n  // ] ]\n]\n","// @flow\n\nimport { assert } from 'chai'\nimport { describe, it } from 'mocha'\n\nimport { search } from '../../src/utils/jsonSearch.js'\nimport { fixtures, jsonObj } from './fixtures/jsonSearch.js'\n\ndescribe('Testing Json Search', function () {\n  fixtures.forEach(([ test, expected ]) => {\n    it(`Testing search with: ${JSON.stringify(test)} `, function () {\n      const searchParams = {\n        keyToMatch: test[0],\n        valueToMatch: test[1]\n        // keyToReturn: test[2]\n      }\n      const results = search(searchParams, jsonObj)\n      // console.log('results', results)\n      // console.log('expected', expected)\n      assert.deepEqual(results, expected)\n    })\n  })\n})\n"],"names":["search","searchParams","jsonObj","keyToMatch","valueToMatch","parent","tokenizeKeys","split","length","results","console","log","result","slice","concat","key","alpha","bravo","charlie","delta","india","kilo","lima","uniform","echo","foxtrot","golf","juliet","mike","november","fixtures","describe","forEach","test","expected","it","JSON","stringify","assert","deepEqual"],"mappings":";;;;;AAIO,MAAMA,MAAM,GAAG,CAACC,YAAD,EAAiCC,OAAjC,KAAuD;;;;;;;;;MAUvE,OAAOA,OAAP,KAAmB,WAAvB,EAAoC,OAAO,IAAP;QAE9B;IACJC,UADI;IAEJC,YAFI;;IAIJC,MAJI;IAKJC,YAAY,GAAGH,UAAU,GAAGA,UAAU,CAACI,KAAX,CAAiB,GAAjB,CAAH,GAA2B;MAClDN,YANJ;;MAQI,CAACK,YAAY,CAACE,MAAlB,EAA0B;QACpB,OAAOJ,YAAP,KAAwB,WAAxB,IAAuCA,YAAY,KAAKF,OAA5D,EAAqE;aAC5DG,MAAM,GAAG,CAACA,MAAD,CAAH,GAAc,CAACH,OAAD,CAA3B;;;WAEK,IAAP;;;MAGEO,OAAO,GAAG,EAAd,CA3B2E;;;;;;;;;;;;;;;MA4CvE,OAAOP,OAAP,KAAmB,QAAvB,EAAiC;IAC/BQ,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BL,YAA/B;IACAI,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BT,OAA1B,EAF+B;;UAIzBU,MAAM,GAAGZ,MAAM,CAAC;MACpBG,UADoB;MAEpBC,YAFoB;;MAIpBC,MAAM,EAAEH,OAJY;MAKpBI,YAAY,EAAEA,YAAY,CAACO,KAAb,CAAmB,CAAnB;KALK,EAMlBX,OAAO,CAACI,YAAY,CAAC,CAAD,CAAb,CANW,CAArB;;QAQIM,MAAJ,EAAY;MACVF,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCC,MAAjC;MACAH,OAAO,GAAGA,OAAO,CAACK,MAAR,CAAeF,MAAf,CAAV;KAd6B;;;;QAmB3B,CAACP,MAAL,EAAa;MACXK,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BT,OAA1B;;WACK,MAAMa,GAAX,IAAkBb,OAAlB,EAA2B;QACzBQ,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBI,GAAtB;cACMH,MAAM,GAAGZ,MAAM,CAAC;UACpBG,UADoB;UAEpBC,YAFoB;;UAIpBE;SAJmB,EAKlBJ,OAAO,CAACa,GAAD,CALW,CAArB;;YAMIH,MAAJ,EAAY;UACVF,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCC,MAApC;UACAH,OAAO,GAAGA,OAAO,CAACK,MAAR,CAAeF,MAAf,CAAV;;;;;;SAMDH,OAAO,CAACD,MAAR,GAAiBC,OAAjB,GAA2B,IAAlC;CAjFK;;ACJA,MAAMP,OAAO,GAAG;EACrBc,KAAK,EAAE,CADc;EAErBC,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAFc;EAGrBC,OAAO,EAAE;IAAEC,KAAK,EAAE;GAHG;EAIrBC,KAAK,EAAE;IACLC,IAAI,EAAE,CADD;IAELC,IAAI,EAAE;GANa;EAQrBC,OAAO,EAAE;IACPF,IAAI,EAAE,CADC;IAEPC,IAAI,EAAE;GAVa;EAYrBE,IAAI,EAAE;IACJC,OAAO,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CADL;IAEJC,IAAI,EAAE;MACJN,KAAK,EAAE;QACLC,IAAI,EAAE,CADD;QAELC,IAAI,EAAE;OAHJ;MAKJK,MAAM,EAAE;QACNN,IAAI,EAAE,CADA;QAENC,IAAI,EAAE;OAPJ;MASJM,IAAI,EAAE,CACJ;QAAEP,IAAI,EAAE;OADJ,EAEJ,CAFI,EAGJ;QAAEC,IAAI,EAAE;OAHJ,EAIJ;QAAEA,IAAI,EAAE,CAAR;QAAWD,IAAI,EAAE;OAJb,EAKJ;QAAEH,OAAO,EAAE;UAAEC,KAAK,EAAE;;OALhB,EAMJ;QAAEH,KAAK,EAAE;OANL,EAOJ,CAAE,CAAF,EAAK;QAAEM,IAAI,EAAE;OAAb,EAAkB,EAAlB,CAPI,CATF;MAkBJO,QAAQ,EAAE;;;CAhCT;AAqCP,AAAO,MAAMC,QAAQ,GAAG;;;;;;;AAQtB,CAAE,CAAC,OAAD,EAAU,CAAV,CAAF,EAAgB,CAAC5B,OAAO,CAAC,OAAD,CAAR,CAAhB,CARsB;;;;;;;AAiBtB,CAAE,CAAC,cAAD,EAAiB,CAAjB,CAAF,EAAuB,CACrBA,OAAO,CAAC,MAAD,CAAP,CAAgB,SAAhB,CADqB,CAAvB,CAjBsB;;;;;;;;;;;;;;;;;;;;;;;;CAAjB;;AC7BP6B,cAAQ,CAAC,qBAAD,EAAwB,YAAY;EAC1CD,QAAQ,CAACE,OAAT,CAAiB,CAAC,CAAEC,IAAF,EAAQC,QAAR,CAAD,KAAwB;IACvCC,QAAE,CAAE,wBAAuBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAqB,GAA9C,EAAkD,YAAY;YACxDhC,YAAY,GAAG;QACnBE,UAAU,EAAE8B,IAAI,CAAC,CAAD,CADG;QAEnB7B,YAAY,EAAE6B,IAAI,CAAC,CAAD,CAFC;;OAArB;YAKMxB,OAAO,GAAGT,MAAM,CAACC,YAAD,EAAeC,OAAf,CAAtB,CAN8D;;;MAS9DoC,WAAM,CAACC,SAAP,CAAiB9B,OAAjB,EAA0ByB,QAA1B;KATA,CAAF;GADF;CADM,CAAR"}