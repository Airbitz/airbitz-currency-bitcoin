{"version":3,"file":"tests.cjs.js","sources":["../src/utils/require.js","../src/utils/uintArray.js","../src/utils/hash.js","../src/utils/base.js","../test/utils/base.js","../src/utils/jsonSearch.js","../test/utils/fixtures/jsonSearch.js","../test/utils/jsonSearch.js","../src/utils/persister.js","../test/utils/persister.js"],"sourcesContent":["const lazyHandler = activeModule => ({\n  get: (target, prop, receiver) => {\n    // If already loaded return the loaded module\n    if (activeModule) return activeModule[prop]\n    // Try to inject the loaded module\n    if (prop === 'inject') {\n      return loadedModule => {\n        activeModule = loadedModule\n        for (const prop in target) {\n          target[prop].inject(activeModule[prop])\n        }\n      }\n    }\n    // Create a new child proxy if this prop not yet exists\n    if (!target[prop]) {\n      target[prop] = new Proxy(function (...args) {\n        if (!activeModule) target()\n        return activeModule[prop](...args)\n      }, lazyHandler())\n    }\n    return target[prop]\n  }\n})\n\nexport const lazify = unsafeModule => {\n  const parentModule = function (injectedModule = {}, loadUnsafe = true) {\n    const defaultModule = loadUnsafe ? unsafeModule() : {}\n    const loadedModule = Object.assign(defaultModule, injectedModule)\n    parentProxy.inject(loadedModule)\n  }\n  const parentProxy = new Proxy(parentModule, lazyHandler())\n  return parentProxy\n}\n","// @flow\n\nexport const isHexString = (hex: string) =>\n  typeof hex === 'string' && /^[0-9a-f]*$/i.test(hex)\n\nexport const toUint8Array = (hexString: string): Uint8Array => {\n  if (!isHexString(hexString)) {\n    throw new Error(`${hexString} is Not a Hex string`)\n  }\n  if (hexString.length % 2 !== 0) hexString = `0${hexString}`\n  const hex = hexString.match(/.{1,2}/g) || []\n  const bytes = hex.map(byte => parseInt(byte, 16))\n  return new Uint8Array(bytes)\n}\n\nexport const fromUint8Array = (bytes: Uint8Array): string =>\n  bytes.reduce((str, byte) => str + byte.toString(16).padStart(2, '0'), '')\n","// @flow\n\nimport { type Hashes, type SplittedHmac } from '../../types/utils.js'\nimport { lazify } from './require.js'\nimport { fromUint8Array, toUint8Array } from './uintArray.js'\n\nexport const hashjs: Hashes<Uint8Array> = (lazify(() =>\n  require('hash.js')\n): any)\n\nexport const digest = (hash: Function) => (data: string) => {\n  const uintArray = toUint8Array(data)\n  const rawRes = hash()\n    .update(uintArray)\n    .digest()\n  const resArray = new Uint8Array(rawRes)\n  return fromUint8Array(resArray)\n}\n\nexport const digestHmac = (hmac: Function, hash: Function) => (\n  key: string,\n  data: string\n) => {\n  const uintKey = toUint8Array(key)\n  const hmacHash = () => hmac(hash, uintKey)\n  return digest(hmacHash)(data)\n}\n\nexport const sha256 = digest(hashjs.sha256)\nexport const sha512 = digest(hashjs.sha512)\nexport const ripemd160 = digest(hashjs.ripemd160)\nexport const sha512Hmac = digestHmac(hashjs.hmac, hashjs.sha512)\n\nexport const hash256 = (data: string) => sha256(sha256(data))\nexport const hash160 = (data: string) => ripemd160(sha256(data))\nexport const hmacSplit = (key: string, data: string): SplittedHmac => {\n  const hash = sha512Hmac(key, data)\n  const left = hash.slice(0, 64)\n  const right = hash.slice(64, 128)\n  return { left, right }\n}\n","// @flow\n\nimport { Buffer } from 'buffer'\n\nimport basex from 'base-x'\n\nimport {\n  type Alphabet,\n  type BaseCheck,\n  type BaseDecoder,\n  type Bases,\n  type HashFunction\n} from '../../types/utils.js'\nimport { hash256 } from './hash.js'\n\n// The default ALPHABETS, the name of the base codec will be the alphabet's length\nexport const ALPHABETS: Array<Alphabet> = [\n  '01',\n  '01234567',\n  '0123456789a',\n  '0123456789abcdef',\n  '0123456789ABCDEFGHJKMNPQRSTVWXYZ',\n  '0123456789abcdefghijklmnopqrstuvwxyz',\n  '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz',\n  '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n]\n\nexport const createCheckSumBase = (\n  base: BaseDecoder,\n  hashFunc?: HashFunction<string>\n): BaseDecoder => ({\n  encode: (hexStr: string): string => {\n    const checksum = (hashFunc || hash256)(hexStr)\n    const checkHex = `${hexStr}${checksum.slice(0, 8)}`\n    return base.encode(checkHex)\n  },\n  decode: (baseString: string): string => {\n    const hexStr = base.decode(baseString)\n    const payload = hexStr.slice(0, -8)\n    const newChecksum = (hashFunc || hash256)(payload)\n    const checksum = hexStr.slice(-8)\n    if (newChecksum.startsWith(checksum)) return payload\n    throw new Error('Invalid checksum')\n  }\n})\n\nexport const createHexEncoder = (\n  base: BaseDecoder,\n  hashFunc?: HashFunction<string>\n): BaseCheck => {\n  const newBase = { ...base }\n  const encode: (buf: Buffer) => string = newBase.encode\n  const decode: (str: string) => Buffer = newBase.decode\n  newBase.encode = a => encode(Buffer.from(a, 'hex'))\n  newBase.decode = a => decode(a).toString('hex')\n  return { ...newBase, check: createCheckSumBase(newBase, hashFunc) }\n}\n\nexport const base: Bases = ALPHABETS.reduce((decoders, alphabet) => {\n  const baseDecoder = createHexEncoder(basex(alphabet))\n  return { ...decoders, [alphabet.length]: baseDecoder }\n}, {})\n","// @flow\n\nimport { assert } from 'chai'\nimport { describe, it } from 'mocha'\n\nimport { base } from '../../src/utils/base.js'\nimport { sha512Hmac } from '../../src/utils/hash.js'\nimport fixtures from './fixtures/base.json'\n\nconst data =\n  '00ab0063a7ea84d7c5f4a9ad8690c69b80a2d650343fbc9266b2d73c7b26bb2cc780000020'\nconst key = '485efe44bc445946b58ba03e8da75d5cf44fc9196eaa88204667629c4e04c38d'\nconst res =\n  '405fcc33d3f409f16571e19bd27053cd1d05e74df6eba0dc93c4c0a91599052429203b410e284513e14f67287843f91875bf69986f9cebf7037e79b0b13bbdbc'\n\nconst hash = sha512Hmac(key, data)\nassert.equal(hash, res)\n\nfor (const fixture in fixtures) {\n  describe(`Testing base ${fixture}`, function () {\n    const fixtureBase = base[fixture].check\n\n    fixtures[fixture].valid.forEach(({ string, payload }) => {\n      it(`Decode valid string: ${string}`, async function () {\n        const resultedPaylod = fixtureBase.decode(string)\n        assert.equal(resultedPaylod, payload)\n      })\n      it(`Encode valid payload: ${payload}`, async function () {\n        const resultedString = fixtureBase.encode(payload)\n        assert.equal(resultedString, string)\n      })\n    })\n\n    fixtures[fixture].invalid.forEach(({ string, exception }) => {\n      it(`Test invalid string: ${string}`, async function () {\n        try {\n          fixtureBase.decode(string)\n        } catch (e) {\n          assert.equal(e.message, exception)\n        }\n      })\n    })\n  })\n}\n","// @flow\n\nimport {\n  type QueryParams,\n  type RecQueryParams\n} from '../../types/utils'\n\nconst searchRec = (query: RecQueryParams, jsonObj: any, parent: any): Array<any> => {\n  const { value, results, limit, path } = query\n\n  // If jsonObj is undefined or we have enough results we can return\n  if (\n    typeof jsonObj === 'undefined' ||\n    (limit && results.length >= limit)) return results\n\n  // If we ran out of path we check the following possiblities:\n  if (!path.length) {\n    // 1. If there is no value we can just return the object we are on\n    if (value === undefined) results.push(jsonObj)\n    // 2. If the value equals jsonObj, we need to return the parent\n    else if (value === jsonObj) results.push(parent)\n    // 3. If the jsonObj is an array, we need to decend one last time again\n    else if (Array.isArray(jsonObj)) {\n      jsonObj.forEach(c => searchRec(query, c, jsonObj))\n    }\n  } else if (typeof jsonObj === 'object') {\n    // Get a mutable version of path\n    let { path } = query\n\n    // If it's a recursive token, decent into all children\n    // And remove the recursive token from the path array\n    if (!path[0]) {\n      path = path.slice(1)\n      for (const key in jsonObj) {\n        searchRec(query, jsonObj[key], jsonObj)\n      }\n    }\n\n    const childKey = path[0]\n    const childQuery = { ...query, path: path.slice(1) }\n\n    if (childKey === '*') {\n      for (const key in jsonObj) {\n        searchRec(childQuery, jsonObj[key], jsonObj)\n      }\n    } else {\n      // Decent into child based on the first key in path\n      // With jsonObj as the parent and shifted path\n      searchRec(childQuery, jsonObj[childKey], jsonObj)\n    }\n  }\n\n  return results\n}\n\nexport const search = (query: QueryParams | string, jsonObj: any): Array<any> => {\n  if (typeof query === 'string') query = { path: query }\n  const { path: stringPath, ...rest } = query\n  // If nothing was requested, return the current object\n  if (!stringPath) return [jsonObj]\n  // Tokenize the search terms\n  const path = stringPath.split('.')\n  // Remove the root token if exists\n  if (path[0] === '$') path.shift()\n  // Call the recursive search\n  return searchRec({ ...rest, path, results: [] }, jsonObj)\n}\n","export const jsonObj = {\n  alpha: 1,\n  bravo: [1, 2, 3],\n  charlie: { delta: 1 },\n  india: {\n    kilo: 4,\n    lima: 4\n  },\n  uniform: {\n    kilo: 4,\n    lima: 4\n  },\n  echo: {\n    foxtrot: [1, 2, 3],\n    golf: {\n      india: {\n        kilo: 4,\n        lima: 4\n      },\n      juliet: {\n        kilo: 4,\n        lima: 5\n      },\n      mike: [\n        { kilo: 4 },\n        6,\n        { lima: 5 },\n        { lima: 6, kilo: 7 },\n        { charlie: { delta: 1 } },\n        { alpha: 1 },\n        [ 6, { lima: 5 }, 10 ]\n      ],\n      november: 8\n    }\n  }\n}\n\nexport const fixtures = [\n  [ [], [jsonObj] ],\n\n  [ ['$.lima'], [] ],\n\n  [ ['lima'], [] ],\n\n  [ ['$..lima'], [\n    jsonObj['india']['lima'],\n    jsonObj['uniform']['lima'],\n    jsonObj['echo']['golf']['india']['lima'],\n    jsonObj['echo']['golf']['juliet']['lima'],\n    jsonObj['echo']['golf']['mike'][2]['lima'],\n    jsonObj['echo']['golf']['mike'][3]['lima'],\n    jsonObj['echo']['golf']['mike'][6][1]['lima']\n  ] ],\n\n  [ ['$..charlie'], [\n    jsonObj['echo']['golf']['mike'][4]['charlie'],\n    jsonObj['charlie']\n  ] ],\n\n  [ ['$.charlie.delta', 1], [\n    jsonObj['charlie']\n  ] ],\n\n  [ ['charlie.delta', 1], [\n    jsonObj['charlie']\n  ] ],\n\n  [ ['echo.golf.india.kilo', 4], [\n    jsonObj['echo']['golf']['india']\n  ] ],\n\n  [ ['$.lima', 1], [] ],\n\n  [ ['lima', 1], [] ],\n\n  [ ['$..alpha', 1], [\n    jsonObj['echo']['golf']['mike'][5],\n    jsonObj\n  ] ],\n\n  [ ['$..alpha', 2], [] ],\n\n  [ ['$..charlie', 1], [] ],\n\n  [ ['$..delta', 1], [\n    jsonObj['charlie'],\n    jsonObj['echo']['golf']['mike'][4]['charlie']\n  ] ],\n\n  [ ['$..charlie.delta', 1], [\n    jsonObj['charlie'],\n    jsonObj['echo']['golf']['mike'][4]['charlie']\n  ] ],\n\n  [ ['$..india.kilo', 5], [] ],\n\n  [ ['$..india.lima', 5], [] ],\n\n  [ ['$..echo.golf.india.kilo', 4], [jsonObj['echo']['golf']['india']] ],\n\n  [ ['$..echo.golf.india.kilo', 5], [] ],\n\n  [ ['$..echo.golf.november', 8], [jsonObj['echo']['golf']] ],\n\n  [ ['$..india.kilo', 4], [\n    jsonObj['india'],\n    jsonObj['echo']['golf']['india']\n  ] ],\n\n  [ ['$..lima', 5], [\n    jsonObj['echo']['golf']['juliet'],\n    jsonObj['echo']['golf']['mike'][2],\n    jsonObj['echo']['golf']['mike'][6][1]\n  ] ],\n\n  [ ['$..lima', 4], [\n    jsonObj['india'],\n    jsonObj['uniform'],\n    jsonObj['echo']['golf']['india']\n  ] ],\n\n  [ ['$..kilo', 4], [\n    jsonObj['india'],\n    jsonObj['uniform'],\n    jsonObj['echo']['golf']['india'],\n    jsonObj['echo']['golf']['juliet'],\n    jsonObj['echo']['golf']['mike'][0]\n  ] ],\n\n  [ ['$..golf..delta', 1], [\n    jsonObj['echo']['golf']['mike'][4]['charlie']\n  ] ],\n\n  [ ['$..mike..delta', 1], [\n    jsonObj['echo']['golf']['mike'][4]['charlie']\n  ] ],\n\n  [ ['$..echo.foxtrot', 2], [\n    jsonObj['echo']['foxtrot']\n  ] ],\n\n  [ ['$..bravo', 0], [] ],\n\n  [ ['$..bravo', 1], [jsonObj['bravo']] ],\n\n  [ ['$..bravo'], [\n    jsonObj['bravo']\n  ] ],\n\n  [ ['bravo'], [\n    jsonObj['bravo']\n  ] ],\n\n  [ ['$.bravo'], [\n    jsonObj['bravo']\n  ] ],\n\n  [ ['$.echo.foxtrot'], [\n    jsonObj['echo']['foxtrot']\n  ] ],\n\n  [ ['$..mike'], [\n    jsonObj['echo']['golf']['mike']\n  ] ],\n\n  [ ['$.echo.golf.*'], [\n    jsonObj['echo']['golf']['india'],\n    jsonObj['echo']['golf']['juliet'],\n    jsonObj['echo']['golf']['mike'],\n    jsonObj['echo']['golf']['november']\n  ] ],\n\n  [ ['$.*'], [\n    jsonObj['alpha'],\n    jsonObj['bravo'],\n    jsonObj['charlie'],\n    jsonObj['india'],\n    jsonObj['uniform'],\n    jsonObj['echo']\n  ] ]\n]\n","// @flow\n\nimport { assert } from 'chai'\nimport { describe, it } from 'mocha'\n\nimport { search } from '../../src/utils/jsonSearch.js'\nimport { fixtures, jsonObj } from './fixtures/jsonSearch.js'\n\ndescribe('Testing Json Search', function () {\n  fixtures.forEach(([ test, expected ]) => {\n    it(`Testing search with: ${JSON.stringify(test)} and no limit`, function () {\n      const searchParams = {\n        path: test[0],\n        value: test[1]\n      }\n      const results = search(searchParams, jsonObj)\n      assert.deepEqual(results, expected)\n    })\n\n    for (let i = 1; i <= expected.length; i++) {\n      it(`Testing search with: ${JSON.stringify(test)} and limit ${i}`, function () {\n        const searchParams = {\n          path: test[0],\n          value: test[1],\n          limit: i\n        }\n        const results = search(searchParams, jsonObj)\n        assert.deepEqual(results, expected.slice(0, i))\n      })\n    }\n  })\n})\n","// @flow\n\nimport {\n  type LoadFunc,\n  type PersistStatus,\n  type SaveFunc\n} from '../../types/utils.js'\n\nexport const persist = (\n  save: SaveFunc,\n  load: LoadFunc | Object,\n  delay: number = 100,\n  cache: Object = {},\n  data: Object = cache,\n  status: PersistStatus = {}\n) => {\n  return new Proxy((Object.assign(() => save(cache), data): any), {\n    apply: async (target, thisArgs, args) => {\n      const updateCache = newCache => {\n        cache = newCache\n        data = newCache\n        for (const key in target) {\n          if (data[key] === undefined) {\n            delete target[key]\n          }\n        }\n        Object.assign(target, newCache)\n      }\n\n      // Try to load the cache from disk in case it never happend before\n      if (!status.loaded) {\n        const rawData = typeof load === 'function' ? await load() : load\n        updateCache({ ...rawData, ...cache })\n        status.loaded = true\n      }\n\n      // Load/Stop the cache based on the argument\n      if (args && args.length) {\n        if (typeof args[0] === 'object') updateCache({ ...args[0] })\n        else if (args[0] === 'stop') {\n          if (status.saving) {\n            clearTimeout(status.saving)\n            status.saving = null\n          }\n          status.changed = false\n          await Reflect.apply(target, target, [])\n          return\n        }\n      }\n\n      // Stop looping in case nothing changed or we already have a save timer\n      if (!status.changed || status.saving) return\n\n      // If something changed, set flags and call save\n      status.changed = false\n\n      // Set save loop after the desired delay\n      status.saving = setTimeout(() => {\n        if (status.saving) {\n          clearTimeout(status.saving)\n          status.saving = null\n        }\n        Reflect.apply(thisArgs, thisArgs, [])\n      }, delay)\n\n      await Reflect.apply(target, target, [])\n    },\n    set: (target: any, prop: string, value: any, receiver: any) => {\n      // Only update/save if the param actually changed\n      if (data[prop] !== value) {\n        Reflect.set(data, prop, value)\n        Reflect.set(target, prop, value)\n        status.changed = true\n        if (!status.saving) Reflect.apply(receiver, receiver, [])\n      }\n      return true\n    },\n    get: (target: any, prop: string) => {\n      if (prop === 'status') return status\n      // Get the value\n      const value = Reflect.get(data, prop)\n      // Return any non object values\n      if (typeof value !== 'object') return value\n      // Create a proxy from the child to trimgger saves on the top parent\n      return persist(save, load, delay, cache, value, status)\n    }\n  })\n}\n","// @flow\n\nimport { assert } from 'chai'\nimport { after, before, describe, it } from 'mocha'\n\nimport { persist } from '../../src/utils/persister.js'\nimport fixtures from './fixtures/persistor.json'\n\nconst createSave = (expected: any, delay: number, cbs: any) => {\n  let saveAttempts = -1\n  let firstSaveTime = 0\n\n  return async cacheData => {\n    if (cbs.stop) return\n    cbs.e = new Error()\n\n    assert.notEqual(cacheData, expected)\n    assert.deepEqual(cacheData, expected)\n\n    saveAttempts++\n    if (!firstSaveTime) firstSaveTime = Date.now()\n    const saveTime = Date.now() - firstSaveTime\n\n    if (delay) {\n      const minDelay = delay * saveAttempts\n      assert.isAtLeast(saveTime, minDelay)\n    }\n\n    cbs.e = null\n    // console.log(saveTime, '- SAVE -', cacheData, saveAttempts)\n  }\n}\n\nconst cbs = {}\n\nfor (const test in fixtures) {\n  const testNum = test.replace('scenario ', '')\n  const { cache, delay, sets } = fixtures[test]\n  const expected = JSON.parse(JSON.stringify(cache || {}))\n  const save = createSave(expected, delay, cbs)\n  const load = testNum !== '1' ? (): Object => expected : cache\n  const persistedCache = persist(save, load, delay)\n\n  describe(`Testing persister for ${test} with delay of ${delay ||\n    100}ms`, function () {\n    this.timeout(0)\n    before('Test using cache as a function', async function () {\n      cbs.stop = false\n      await persistedCache({})\n      await persistedCache(cache)\n    })\n\n    sets.map(([param, value, saveTime], i) => {\n      it(`Set '${param}' to ${value}, after ${saveTime} milliseconds`, function (done) {\n        let child = persistedCache\n        let expectedChild = expected\n\n        param = param.split('.')\n        while (param.length > 1) {\n          const key = param.shift()\n          child = child[key]\n          expectedChild = expectedChild[key]\n        }\n\n        const key = param[0]\n        const interval = !i ? saveTime : saveTime - sets[i - 1][2]\n\n        setTimeout(() => {\n          expectedChild[key] = value\n          child[key] = value\n          assert.equal(expectedChild[key], child[key])\n          done(cbs.e)\n        }, interval)\n      })\n    })\n\n    after('Stop the caceh using cache as a function', async function () {\n      cbs.stop = true\n      await persistedCache('stop')\n    })\n  })\n}\n"],"names":["lazyHandler","activeModule","get","target","prop","receiver","loadedModule","inject","Proxy","args","lazify","unsafeModule","parentModule","injectedModule","loadUnsafe","defaultModule","Object","assign","parentProxy","isHexString","hex","test","toUint8Array","hexString","Error","length","match","bytes","map","byte","parseInt","Uint8Array","fromUint8Array","reduce","str","toString","padStart","hashjs","require","digest","hash","data","uintArray","rawRes","update","resArray","digestHmac","hmac","key","uintKey","hmacHash","sha256","sha512Hmac","sha512","hash256","ALPHABETS","createCheckSumBase","base","hashFunc","encode","hexStr","checksum","checkHex","slice","decode","baseString","payload","newChecksum","startsWith","createHexEncoder","newBase","a","Buffer","from","check","decoders","alphabet","baseDecoder","basex","res","assert","equal","fixture","fixtures","describe","fixtureBase","valid","forEach","string","it","resultedPaylod","resultedString","invalid","exception","e","message","searchRec","query","jsonObj","parent","value","results","limit","path","undefined","push","Array","isArray","c","childKey","childQuery","search","stringPath","rest","split","shift","alpha","bravo","charlie","delta","india","kilo","lima","uniform","echo","foxtrot","golf","juliet","mike","november","expected","JSON","stringify","searchParams","deepEqual","i","persist","save","load","delay","cache","status","apply","thisArgs","updateCache","newCache","loaded","rawData","saving","clearTimeout","changed","Reflect","setTimeout","set","createSave","cbs","saveAttempts","firstSaveTime","cacheData","stop","notEqual","Date","now","saveTime","minDelay","isAtLeast","testNum","replace","sets","parse","persistedCache","timeout","before","param","done","child","expectedChild","interval","after"],"mappings":"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"}